"use strict";(self["webpackChunkvue2"]=self["webpackChunkvue2"]||[]).push([[145],{51145:function(e,t,s){s.r(t),s.d(t,{default:function(){return D}});var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("t-card",[s("t-row",[s("t-button",{directives:[{name:"permission",rawName:"v-permission",value:e.permissions.USER_ROLES_CREATE,expression:"permissions.USER_ROLES_CREATE"}],on:{click:e.handleCreate}},[e._v("创建角色")])],1),s("t-table",{attrs:{"row-key":"index",data:e.roles,columns:e.columns,pagination:e.paging},scopedSlots:e._u([{key:"operation",fn:function(t){return[s("t-button",{directives:[{name:"permission",rawName:"v-permission",value:e.permissions.USER_ROLES_EDIT,expression:"permissions.USER_ROLES_EDIT"}],attrs:{variant:"text",theme:"primary"},on:{click:function(s){return e.handleEdit(t)}}},[s("icon",{attrs:{name:"edit"}}),e._v("编辑")],1),s("t-button",{directives:[{name:"permission",rawName:"v-permission",value:e.permissions.USER_ROLES_DELETE,expression:"permissions.USER_ROLES_DELETE"}],attrs:{variant:"text",theme:"danger"}},[s("icon",{attrs:{name:"delete"}}),e._v("删除")],1)]}}])}),s("role-edit-dialog",{attrs:{show:e.showRoleEditDialog,data:e.editData},on:{close:e.onClose}})],1)},i=[],l=s(53501),o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("t-dialog",{ref:"dialog",attrs:{header:e.data?"编辑角色":"创建角色",visible:e.visible,width:"900px",closeOnOverlayClick:!1,closeOnEscKeydown:!1},on:{"update:visible":function(t){e.visible=t},close:function(t){return e.$emit("close")},confirm:e.onSubmit,cancel:function(t){return e.$emit("close")}}},[e.role?s("t-form",{ref:"form",attrs:{data:e.role,rules:e.rules}},[s("t-form-item",{attrs:{label:"角色",name:"name"}},[s("t-input",{attrs:{placeholder:"请输角色名称容"},model:{value:e.role.name,callback:function(t){e.$set(e.role,"name",t)},expression:"role.name"}})],1),s("t-form-item",{attrs:{label:"角色标识",name:"label"}},[s("t-input",{attrs:{placeholder:"请输入角色标识"},model:{value:e.role.label,callback:function(t){e.$set(e.role,"label",t)},expression:"role.label"}})],1),s("t-form-item",{attrs:{label:"权限集",name:"permissions"}},[s("t-tree",{attrs:{data:e.permissionsTree,hover:"","expand-all":"",checkable:!0,"value-mode":"all"},model:{value:e.role.permissions,callback:function(t){e.$set(e.role,"permissions",t)},expression:"role.permissions"}})],1)],1):e._e()],1)},r=[],n=s(75815),m=s(37217);const c=e=>(0,m.v)("/roles",e),u=(e,t)=>(0,m.v)(`/roles/${e}`,t),d=e=>(0,m.v)(`/roles/${e}/delete`),p=e=>(0,m.U)("/roles",{params:e});var h={create:c,remove:d,list:p,update:u},E={name:"RoleEditDialog",props:{show:{type:Boolean},data:{type:Object,value:null}},watch:{show:function(e){this.visible=e},data:function(e){this.role=e}},data(){return{visible:!1,role:{name:"",label:"",permissions:[]},rules:{name:[{required:!0,message:"角色名称不能为空",trigger:"blur"}],label:[{required:!0,message:"角色标识不能为空",trigger:"blur"}],permissions:[{required:!0,message:"请选择角色权限集",trigger:"blur"}]},permissionsTree:n.d}},methods:{async onSubmit(){const e=await this.$refs.form.validate();!0===e&&(await h.create(this.role),this.role={name:"",label:"",permissions:[]},this.$emit("close"),await this.$message.success("角色创建成功"))}}},v=E,g=s(1001),b=(0,g.Z)(v,o,r,!1,null,"2e8e6ad9",null),f=b.exports,R={name:"UserRoles",components:{RoleEditDialog:f,Icon:l.J},data(){return{columns:[{colKey:"name",title:"角色名称"},{colKey:"label",title:"角色标识"},{colKey:"operation",title:"操作"}],roles:[{name:"ROLE_USER",label:"普通用户"},{name:"ROLE_ADMIN",label:"管理员"}],showRoleEditDialog:!1,editData:null,paging:{current:1,pageSize:10,total:0},permissions:n.m}},mounted(){this.fetchData()},methods:{async fetchData(){const{data:e,paging:t}=await h.list({});this.roles=e,this.paging.current=t.page,this.paging.pageSize=t.size,this.paging.total=t.total},handleCreate(){this.showRoleEditDialog=!0},handleEdit({row:e}){this.editData=e,this.showRoleEditDialog=!0},onClose(){this.showRoleEditDialog=!1,this.editData=null}}},w=R,_=(0,g.Z)(w,a,i,!1,null,"3ecc4e61",null),D=_.exports}}]);
//# sourceMappingURL=145.e445b1bc.js.map