{"version":3,"file":"js/145.e445b1bc.js","mappings":"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","sources":["webpack://vue2/./src/views/user/roles.vue?581e","webpack://vue2/./src/views/user/role-edit-dialog.vue?d3a6","webpack://vue2/./src/api/role.js","webpack://vue2/src/views/user/role-edit-dialog.vue","webpack://vue2/./src/views/user/role-edit-dialog.vue?0547","webpack://vue2/./src/views/user/role-edit-dialog.vue","webpack://vue2/src/views/user/roles.vue","webpack://vue2/./src/views/user/roles.vue?6170","webpack://vue2/./src/views/user/roles.vue"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('t-card',[_c('t-row',[_c('t-button',{directives:[{name:\"permission\",rawName:\"v-permission\",value:(_vm.permissions.USER_ROLES_CREATE),expression:\"permissions.USER_ROLES_CREATE\"}],on:{\"click\":_vm.handleCreate}},[_vm._v(\"创建角色\")])],1),_c('t-table',{attrs:{\"row-key\":\"index\",\"data\":_vm.roles,\"columns\":_vm.columns,\"pagination\":_vm.paging},scopedSlots:_vm._u([{key:\"operation\",fn:function(slotProps){return [_c('t-button',{directives:[{name:\"permission\",rawName:\"v-permission\",value:(_vm.permissions.USER_ROLES_EDIT),expression:\"permissions.USER_ROLES_EDIT\"}],attrs:{\"variant\":\"text\",\"theme\":\"primary\"},on:{\"click\":function($event){return _vm.handleEdit(slotProps)}}},[_c('icon',{attrs:{\"name\":\"edit\"}}),_vm._v(\"编辑\")],1),_c('t-button',{directives:[{name:\"permission\",rawName:\"v-permission\",value:(_vm.permissions.USER_ROLES_DELETE),expression:\"permissions.USER_ROLES_DELETE\"}],attrs:{\"variant\":\"text\",\"theme\":\"danger\"}},[_c('icon',{attrs:{\"name\":\"delete\"}}),_vm._v(\"删除\")],1)]}}])}),_c('role-edit-dialog',{attrs:{\"show\":_vm.showRoleEditDialog,\"data\":_vm.editData},on:{\"close\":_vm.onClose}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('t-dialog',{ref:\"dialog\",attrs:{\"header\":_vm.data ? '编辑角色' : '创建角色',\"visible\":_vm.visible,\"width\":\"900px\",\"closeOnOverlayClick\":false,\"closeOnEscKeydown\":false},on:{\"update:visible\":function($event){_vm.visible=$event},\"close\":function($event){return _vm.$emit('close')},\"confirm\":_vm.onSubmit,\"cancel\":function($event){return _vm.$emit('close')}}},[(_vm.role)?_c('t-form',{ref:\"form\",attrs:{\"data\":_vm.role,\"rules\":_vm.rules}},[_c('t-form-item',{attrs:{\"label\":\"角色\",\"name\":\"name\"}},[_c('t-input',{attrs:{\"placeholder\":\"请输角色名称容\"},model:{value:(_vm.role.name),callback:function ($$v) {_vm.$set(_vm.role, \"name\", $$v)},expression:\"role.name\"}})],1),_c('t-form-item',{attrs:{\"label\":\"角色标识\",\"name\":\"label\"}},[_c('t-input',{attrs:{\"placeholder\":\"请输入角色标识\"},model:{value:(_vm.role.label),callback:function ($$v) {_vm.$set(_vm.role, \"label\", $$v)},expression:\"role.label\"}})],1),_c('t-form-item',{attrs:{\"label\":\"权限集\",\"name\":\"permissions\"}},[_c('t-tree',{attrs:{\"data\":_vm.permissionsTree,\"hover\":\"\",\"expand-all\":\"\",\"checkable\":true,\"value-mode\":\"all\"},model:{value:(_vm.role.permissions),callback:function ($$v) {_vm.$set(_vm.role, \"permissions\", $$v)},expression:\"role.permissions\"}})],1)],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { get, post } from \"@/api/requist\";\n\nconst create = (role) => {\n  return post(\"/roles\", role);\n};\n\nconst update = (id, fields) => {\n  return post(`/roles/${id}`, fields);\n};\n\nconst remove = (id) => {\n  return post(`/roles/${id}/delete`);\n};\n\nconst list = (filter) => {\n  return get(\"/roles\", { params: filter });\n};\n\nexport default {\n  create,\n  remove,\n  list,\n  update,\n};\n","<template>\n  <t-dialog\n    ref=\"dialog\"\n    :header=\"data ? '编辑角色' : '创建角色'\"\n    :visible.sync=\"visible\"\n    width=\"900px\"\n    :closeOnOverlayClick=\"false\"\n    :closeOnEscKeydown=\"false\"\n    @close=\"$emit('close')\"\n    @confirm=\"onSubmit\"\n    @cancel=\"$emit('close')\"\n  >\n    <t-form v-if=\"role\" ref=\"form\" :data=\"role\" :rules=\"rules\">\n      <t-form-item label=\"角色\" name=\"name\">\n        <t-input placeholder=\"请输角色名称容\" v-model=\"role.name\" />\n      </t-form-item>\n      <t-form-item label=\"角色标识\" name=\"label\">\n        <t-input placeholder=\"请输入角色标识\" v-model=\"role.label\" />\n      </t-form-item>\n      <t-form-item label=\"权限集\" name=\"permissions\">\n        <t-tree\n          :data=\"permissionsTree\"\n          hover\n          expand-all\n          :checkable=\"true\"\n          value-mode=\"all\"\n          v-model=\"role.permissions\"\n        />\n      </t-form-item>\n    </t-form>\n  </t-dialog>\n</template>\n\n<script>\nimport { permissionsTree } from \"@/config/permission.config.js\";\nimport roleApi from \"@/api/role.js\";\n\nexport default {\n  name: \"RoleEditDialog\",\n  props: {\n    show: {\n      type: Boolean,\n    },\n    data: {\n      type: Object,\n      value: null,\n    },\n  },\n  watch: {\n    show: function (value) {\n      this.visible = value;\n    },\n    data: function (value) {\n      this.role = value;\n    },\n  },\n\n  data() {\n    return {\n      visible: false,\n      role: {\n        name: \"\",\n        label: \"\",\n        permissions: [],\n      },\n      rules: {\n        name: [\n          { required: true, message: \"角色名称不能为空\", trigger: \"blur\" },\n        ],\n        label: [\n          { required: true, message: \"角色标识不能为空\", trigger: \"blur\" },\n        ],\n        permissions: [\n          { required: true, message: \"请选择角色权限集\", trigger: \"blur\" },\n        ],\n      },\n      permissionsTree,\n    };\n  },\n  methods: {\n    async onSubmit() {\n      const validated = await this.$refs.form.validate();\n      if (validated === true) {\n        await roleApi.create(this.role);\n        this.role = {\n          name: \"\",\n          label: \"\",\n          permissions: [],\n        };\n        this.$emit(\"close\");\n        await this.$message.success(\"角色创建成功\");\n      }\n    },\n  },\n};\n</script>\n\n<style scoped></style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./role-edit-dialog.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./role-edit-dialog.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./role-edit-dialog.vue?vue&type=template&id=2e8e6ad9&scoped=true&\"\nimport script from \"./role-edit-dialog.vue?vue&type=script&lang=js&\"\nexport * from \"./role-edit-dialog.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2e8e6ad9\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <t-card>\n    <t-row>\n      <t-button\n        v-permission=\"permissions.USER_ROLES_CREATE\"\n        @click=\"handleCreate\"\n        >创建角色</t-button\n      >\n    </t-row>\n    <t-table\n      row-key=\"index\"\n      :data=\"roles\"\n      :columns=\"columns\"\n      :pagination=\"paging\"\n    >\n      <template #operation=\"slotProps\">\n        <t-button\n          v-permission=\"permissions.USER_ROLES_EDIT\"\n          variant=\"text\"\n          theme=\"primary\"\n          @click=\"handleEdit(slotProps)\"\n          ><icon name=\"edit\"></icon>编辑</t-button\n        >\n        <t-button\n          v-permission=\"permissions.USER_ROLES_DELETE\"\n          variant=\"text\"\n          theme=\"danger\"\n          ><icon name=\"delete\"></icon>删除</t-button\n        >\n      </template>\n    </t-table>\n    <role-edit-dialog\n      :show=\"showRoleEditDialog\"\n      :data=\"editData\"\n      @close=\"onClose\"\n    ></role-edit-dialog>\n  </t-card>\n</template>\n\n<script>\nimport { Icon } from \"tdesign-icons-vue\";\nimport RoleEditDialog from \"@/views/user/role-edit-dialog.vue\";\nimport roleApi from \"@/api/role\";\nimport { permissions } from \"@/config/permission.config.js\";\n\nexport default {\n  name: \"UserRoles\",\n  components: {\n    RoleEditDialog,\n    Icon,\n  },\n  data() {\n    return {\n      columns: [\n        { colKey: \"name\", title: \"角色名称\" },\n        { colKey: \"label\", title: \"角色标识\" },\n        { colKey: \"operation\", title: \"操作\" },\n      ],\n      roles: [\n        { name: \"ROLE_USER\", label: \"普通用户\" },\n        { name: \"ROLE_ADMIN\", label: \"管理员\" },\n      ],\n      showRoleEditDialog: false,\n      editData: null,\n      paging: {\n        current: 1,\n        pageSize: 10,\n        total: 0,\n      },\n      permissions,\n    };\n  },\n  mounted() {\n    this.fetchData();\n  },\n  methods: {\n    async fetchData() {\n      const { data, paging } = await roleApi.list({});\n      this.roles = data;\n      this.paging.current = paging.page;\n      this.paging.pageSize = paging.size;\n      this.paging.total = paging.total;\n    },\n    handleCreate() {\n      this.showRoleEditDialog = true;\n    },\n    handleEdit({ row }) {\n      this.editData = row;\n      this.showRoleEditDialog = true;\n    },\n    onClose() {\n      this.showRoleEditDialog = false;\n      this.editData = null;\n    },\n  },\n};\n</script>\n\n<style scoped></style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./roles.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./roles.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./roles.vue?vue&type=template&id=3ecc4e61&scoped=true&\"\nimport script from \"./roles.vue?vue&type=script&lang=js&\"\nexport * from \"./roles.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3ecc4e61\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_h","$createElement","_c","_self","directives","name","rawName","value","permissions","expression","on","handleCreate","_v","attrs","roles","columns","paging","scopedSlots","_u","key","fn","slotProps","$event","handleEdit","showRoleEditDialog","editData","onClose","staticRenderFns","ref","data","visible","$emit","onSubmit","role","rules","model","callback","$$v","$set","permissionsTree","_e","create","post","update","id","fields","remove","list","filter","get","params","props","show","type","watch","label","required","message","trigger","methods","component","components","RoleEditDialog","Icon","colKey","title","current","pageSize","total","mounted","row"],"sourceRoot":""}